function convertPreset(a,b){var c={name:b.name.substr(0,b.name.length-4),date:b.lastModifiedDate.toISOString()},d=new Uint8Array(a);try{var e=decodePresetHeader(d.subarray(0,presetHeaderLength));c.clearFrame=e;var f=convertComponents(d.subarray(presetHeaderLength));c.components=f}catch(g){if(g instanceof ConvertException)return log("Error: "+g.message),null;throw g}return c}function convertComponents(a){for(var b=0,c=[];b<a.length;){var d=getUInt32(a,b),e=getComponentIndex(d,a,b),f=4294967294!==d&&d>builtinMax,g=getComponentSize(a,b+sizeInt+32*f);if(0>e)var h={type:"Unknown: ("+-e+")"};else var i=b+2*sizeInt+32*f,h=window["decode_"+componentTable[e].func](a,i,componentTable[e].fields,componentTable[e].name,i+g);if(!h||"object"!=typeof h)throw new ConvertException("Unknown convert error");c.push(h),b+=g+2*sizeInt+32*f}return c}function getComponentIndex(a,b,c){if(builtinMax>a||4294967294===a){for(var d=0;d<componentTable.length;d++)if(a===componentTable[d].code)return log("Found component: "+componentTable[d].name+" ("+a+")"),d}else for(var d=builtinComponents.length;d<componentTable.length;d++)if(componentTable[d].code instanceof Array&&cmpBytes(b,c+sizeInt,componentTable[d].code))return log("Found component: "+componentTable[d].name),d;return log("Found unknown component (code: "+a+")"),-a}function getComponentSize(a,b){return getUInt32(a,b)}function decodePresetHeader(a){var b=[78,117,108,108,115,111,102,116,32,65,86,83,32,80,114,101,115,101,116,32,48,46,49,26],c=[78,117,108,108,115,111,102,116,32,65,86,83,32,80,114,101,115,101,116,32,48,46,50,26];if(!cmpBytes(a,0,c)&&!cmpBytes(a,0,b))throw new ConvertException("Invalid preset header.");return 1===a[presetHeaderLength-1]}function decode_effectList(a,b){var c=getUInt32(a,b-sizeInt),d={type:"EffectList",enabled:1!==getBit(a,b,1)[0],clearFrame:1===getBit(a,b,0)[0],input:getBlendmodeIn(a,b+2,1)[0],output:getBlendmodeOut(a,b+3,1)[0],inAdjustBlend:getUInt32(a,b+5),outAdjustBlend:getUInt32(a,b+9),inBuffer:getUInt32(a,b+13),outBuffer:getUInt32(a,b+17),inBufferInvert:1===getUInt32(a,b+21),outBufferInvert:1===getUInt32(a,b+25),enableOnBeat:1===getUInt32(a,b+29),onBeatFrames:getUInt32(a,b+33)},e=[0,64,0,0,65,86,83,32,50,46,56,43,32,69,102,102,101,99,116,32,76,105,115,116,32,67,111,110,102,105,103,0,0,0,0,0],f=b+37,g=c-37,h=f;if(cmpBytes(a,f,e)){f+=e.length;var i=getUInt32(a,f);h+=e.length+sizeInt+i,g=c-37-e.length-sizeInt-i,d.codeEnabled=1===getUInt32(a,f+sizeInt);var j=getUInt32(a,f+2*sizeInt);d.init=getSizeString(a,f+2*sizeInt)[0],d.frame=getSizeString(a,f+3*sizeInt+j)[0]}var k=convertComponents(a.subarray(h,h+g));return d.components=k,d}function decode_generic(a,b,c,d,e){for(var f={type:removeSpaces(d)},g=Object.keys(c),h=!1,i=0;i<g.length&&!(b>=e);i++){var j=g[i],k=c[j];if(j.match(/^null[_0-9]*$/))b+=k,h=!1;else{var l,m,n=0,o="number"==typeof k,p="string"==typeof k;if(o){switch(k){case 1:n=1,l=a[b];break;case sizeInt:n=sizeInt,l=getUInt32(a,b);break;default:throw new ConvertException("Invalid field size: "+k+".")}h=!1}else if(p){try{m=window["get"+k](a,b)}catch(q){throw q.message.search(/has no method'/)>=0?new ConvertException("Method '"+k+"' was not found. (correct capitalization?)"):q}l=m[0],n=m[1],h=!1}else if(k&&k.length>=2){"Bit"===k[0]?(h&&(b-=1),h=!0):h=!1;try{m=window["get"+k[0]](a,b,k[1]),l=m[0],k[2]&&(l=window["get"+k[2]](l))}catch(q){throw q.message.search(/has no method/)>=0?new ConvertException("Method '"+k+"' was not found. (correct capitalization?)"):q}n=m[1]}f[j]=l,verbose&&log("k: "+j+", val: "+l+", offset: "+b),b+=n}}return f}function decode_movement(a,b){var c,d={type:"Movement"},e=getUInt32(a,b),f=[];if(0!==e)if(32767===e){var g=getSizeString(a,b+sizeInt+1);b+=g[1],c=g[0]}else f=movementEffects[e];else{var h=getUInt32(a,b+6*sizeInt);f=movementEffects[h]}return f.length&&(d.builtinEffect=f[0]),d.output=getUInt32(a,b+sizeInt)?"50/50":"Replace",d.sourceMapped=getBool(a,b+2*sizeInt,sizeInt)[0],d.coordinates=getCoordinates(a,b+3*sizeInt,sizeInt),d.bilinear=getBool(a,b+4*sizeInt,sizeInt)[0],d.wrap=getBool(a,b+5*sizeInt,sizeInt)[0],f.length&&1!==e&&7!==e&&(c=f[1],d.coordinates=f[2]),d.code=c,d}function decode_avi(a,b){var c={type:"AVI",enabled:getBool(a,b,sizeInt)[0]},d=getNtString(a,b+3*sizeInt);c.file=d[0],c.speed=getUInt32(a,b+5*sizeInt+d[1]);var e=getUInt32(a,b+3*sizeInt+d[1]);return c.output=e?"50/50":getMap8(a,b+sizeInt,{0:"Replace",1:"Additive",4294967296:"50/50"}),c.onBeatAdd=e,c.persist=getUInt32(a,b+4*sizeInt+d[1]),c}function decode_simple(a,b){var c={type:"Simple"},d=getUInt32(a,b);if(64&d)c.audioSource=2&d?"Waveform":"Spectrum",c.renderType="Dots";else switch(3&d){case 0:c.audioSource="Spectrum",c.renderType="Solid";break;case 1:c.audioSource="Spectrum",c.renderType="Lines";break;case 2:c.audioSource="Waveform",c.renderType="Lines";break;case 3:c.audioSource="Waveform",c.renderType="Solid"}return c.audioChannel=getAudioChannel(3&d>>2),c.positionY=getPositionY(3&d>>4),c.colors=getColorList(a,b+sizeInt)[0],c}function getMap1(a,b,c){return[getMapping(c,a[b]),1]}function getMap4(a,b,c){return[getMapping(c,getUInt32(a,b)),sizeInt]}function getMap8(a,b,c){return[getMapping(c,getUInt64(a,b)),2*sizeInt]}function getRadioButton(a,b,c){for(var d=0,e=0;e<c.length;e++){var f=0!==getUInt32(a,b+sizeInt*e);f&&(d=f*(e+1))}return[getMapping(c,d),sizeInt*c.length]}function getMapping(a,b){var c=a[b];if(void 0===c)throw new ConvertException("Map: A value for key '"+b+"' does not exist.");return c}function getCodePFBI(a,b){var c=[["init",3],["perFrame",1],["onBeat",2],["perPoint",0]];return getCodeSection(a,b,c)}function getCodeFBI(a,b){var c=[["init",2],["perFrame",1],["onBeat",0]];return getCodeSection(a,b,c)}function getCodeIFBP(a,b){var c=[["init",0],["perFrame",1],["onBeat",2],["perPoint",3]];return getCodeSection(a,b,c)}function getCodeIFB(a,b){var c=[["init",0],["perFrame",1],["onBeat",2]];return getCodeSection(a,b,c)}function getNtCodeIFB(a,b){var c=[["init",0],["perFrame",1],["onBeat",2]];return getCodeSection(a,b,c,!0)}function getNtCodeIFBP(a,b){var c=[["init",0],["perFrame",1],["onBeat",2],["perPoint",3]];return getCodeSection(a,b,c,!0)}function getCodeSection(a,b,c,d){for(var e=new Array(c.length),f=0,g=0,h=b;g<c.length;g++,h+=i[1]){var i=d?getNtString(a,h):getSizeString(a,h);f+=i[1],e[g]=i[0]}for(var j={},g=0;g<e.length;g++)j[c[g][0]]=e[c[g][1]];return[j,f]}function getColorList(a,b){for(var c=[],d=getUInt32(a,b),e=sizeInt+d*sizeInt;d>0;)b+=sizeInt,c.push(getColor(a,b)[0]),d--;return[c,e]}function getColorMaps(a,b){for(var c=b+480,d=[],e=60,f=0,g=0;8>g;g++){var h=getBool(a,b+e*g,sizeInt)[0],i=getUInt32(a,b+e*g+sizeInt),j=getColorMap(a,c,i);if(h||2!==j.length||"#000000"!==j[0].color||0!==j[0].position||"#ffffff"!==j[1].color||255!==j[1].position){if(d[f]={index:g,enabled:h},allFields){var k=getUInt32(a,b+e*g+2*sizeInt),l=getNtString(a,b+e*g+3*sizeInt)[0];d[f].id=k,d[f].fileName=l}d[f].map=j,f++}else;c+=3*i*sizeInt}return[d,c-b]}function getColorMap(a,b,c){for(var d=[],e=0;c>e;e++){var f=getUInt32(a,b),g=getColor(a,b+sizeInt)[0];b+=3*sizeInt,d[e]={color:g,position:f}}return d}function getColor(a,b){for(var c=getUInt32(a,b).toString(16),d="",e=c.length;6>e;e++)d+="0";return["#"+d+c,sizeInt]}function getConvoFilter(a,b,c){if(!(c instanceof Array)&&2!==c.length)throw new ConvertException("ConvoFilter: Size must be array with x and y dimensions in dwords.");for(var d=c[0]*c[1],e=new Array(d),f=0;d>f;f++,b+=sizeInt)e[f]=getInt32(a,b)[0];var g={width:c[0],height:c[1],data:e};return[g,d*sizeInt]}function getSemiColSplit(a){var b=a.split(";");return 1===b.length?b[0]:b}function getBlendmodeIn(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesIn[d],c]}function getBlendmodeOut(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesOut[d],c]}function getBlendmodeBuffer(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesBuffer[d],c]}function getBlendmodeRender(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesRender[d],c]}function getBlendmodePicture2(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesPicture2[d],c]}function getBlendmodeColorMap(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[blendmodesColorMap[d],c]}function getKeyColorMap(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[keysColorMap[d],c]}function getCycleModeColorMap(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[cycleModesColorMap[d],c]}function getBufferMode(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[buffermodes[d],c]}function getBufferNum(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return 0===d?["Current",c]:[getUInt32(a,b),c]}function getCoordinates(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[coordinates[d],c]}function getDrawMode(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[drawModes[d],c]}function getAudioChannel(a){return audioChannels[a]}function getAudioSource(a){return audioSources[a]}function getPositionX(a){return positionsX[a]}function getPositionY(a){return positionsY[a]}function checkCompat(){compat=window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1}function loadDir(a,b){for(var c=a.files,d=[],e=0;e<c.length;e++)b.test(c[e].name)&&d.push(c[e]);return d}function loadFile(a,b){if(!a instanceof File)return log("Error: 'file' parameter is no file."),!1;if("function"!=typeof b)return log("Error: 'callback' parameter is no function."),!1;log("Loading file "+a.name+"... ");var c=new FileReader;c.onloadend=function(c){c.target.readyState==FileReader.DONE&&b(c.target.result,a)},c.readAsArrayBuffer(a)}function saveAvsAsJson(a,b){var c=convertPreset(a,b),d="#output";$(d).html(JSON.stringify(c,null,prettyPrint?"    ":null)),$(d).each(function(a,b){hljs.highlightBlock(b)})}function jsonPrintSpecials(a,b){return"convolutionMatrix"===a?b.join(","):b}function SelectText(a){var b=document,c=b.getElementById(a);if(b.body.createTextRange){var d=b.body.createTextRange();d.moveToElementText(c),d.select()}else if(window.getSelection){var e=window.getSelection(),d=b.createRange();d.selectNodeContents(c),e.removeAllRanges(),e.addRange(d)}}function log(a){$("#log").prepend(a+"\n")}function ConvertException(a){this.message=a,this.name="ConvertException"}function cmpBytes(a,b,c){for(var d=0;d<c.length;d++)if(null!==c[d]&&a[d+b]!==c[d])return!1;return!0}function getBit(a,b,c){if(c instanceof Array){2!==c.length&&new ConvertException("Wrong Bitfield range");var d=(2<<c[1]-c[0])-1;return[a[b]>>c[0]&d,1]}return[1&a[b]>>c,1]}function getUInt32(a,b){b||(b=0);var c=a.buffer.slice(a.byteOffset+b,a.byteOffset+b+sizeInt);return new Uint32Array(c,0,1)[0]}function getInt32(a,b){b||(b=0);var c=a.buffer.slice(a.byteOffset+b,a.byteOffset+b+sizeInt);return[new Int32Array(c,0,1)[0],4]}function getUInt64(a,b){b||(b=0);var c=a.buffer.slice(a.byteOffset+b,a.byteOffset+b+2*sizeInt),d=new Uint32Array(c,0,2);return d[0]+4294967296*d[1]}function getFloat32(a,b){b||(b=0);var c=a.buffer.slice(a.byteOffset+b,a.byteOffset+b+sizeInt);return[new Float32Array(c,0,1)[0],4]}function getBool(a,b,c){var d=1===c?a[b]:getUInt32(a,b);return[0!==d,c]}function getBoolified(a){return 0==a?!1:!0}function getSizeString(a,b,c){var d=0,e="";c||(c=getUInt32(a,b),d=sizeInt);for(var f=b+c+d,g=b+d,h=a[g];h>0&&f>g;)e+=String.fromCharCode(h),h=a[++g];return[e,c+d]}function getNtString(a,b){for(var c="",d=b,e=a[d];e>0;)c+=String.fromCharCode(e),e=a[++d];return[c,d-b+1]}function removeSpaces(a){return a.replace(/[ ]/g,"")}var builtinComponents=[{name:"Effect List",code:4294967294,group:"",func:"effectList"},{name:"Simple",code:0,group:"Render",func:"simple"},{name:"Dot Plane",code:1,group:"Render",func:"generic",fields:{rotationSpeed:"Int32",colorTop:"Color",colorHigh:"Color",colorMid:"Color",colorLow:"Color",colorBottom:"Color",angle:"Int32",null0:sizeInt}},{name:"Oscilliscope Star",code:2,group:"Render",func:"generic",fields:{audioChannel:["Bit",[2,3],"AudioChannel"],positionX:["Bit",[4,5],"PositionX"],null0:sizeInt-1,colors:"ColorList",size:sizeInt,rotation:sizeInt}},{name:"FadeOut",code:3,group:"Trans",func:"generic",fields:{speed:sizeInt,color:["Color",sizeInt]}},{name:"Blitter Feedback",code:4,group:"Misc",func:"generic",fields:{zoom:sizeInt,onBeatZoom:sizeInt,output:["Map4",{0:"Replace",1:"50/50"}],onBeat:["Bool",sizeInt],bilinear:["Bool",sizeInt]}},{name:"OnBeat Clear",code:5,group:"Render",func:"generic",fields:{color:"Color",output:["Map4",{0:"Replace",1:"50/50"}],clearBeats:sizeInt}},{name:"Blur",code:6,group:"Trans",func:"generic",fields:{blur:["Map4",{0:"None",1:"Medium",2:"Light",3:"Heavy"}],round:["Map4",{0:"Down",1:"Up"}]}},{name:"Bass Spin",code:7,group:"Trans",func:"generic",fields:{enabledLeft:["Bit",0,"Boolified"],enabledRight:["Bit",1,"Boolified"],null0:sizeInt-1,colorLeft:"Color",colorRight:"Color",mode:["Map4",{0:"Lines",1:"Triangles"}]}},{name:"Moving Particle",code:8,group:"Render",func:"generic",fields:{enabled:["Bit",0,"Boolified"],onBeatSizeChange:["Bit",1,"Boolified"],null0:sizeInt-1,color:"Color",range:sizeInt,size:sizeInt,onBeatSize:sizeInt,output:["Map4",{0:"Replace",1:"Additive",2:"50/50",3:"Default"}]}},{name:"Roto Blitter",code:9,group:"Trans",func:"generic",fields:{zoom:sizeInt,rotate:sizeInt,output:["map4",{0:"Replace",1:"50/50"}],onBeatReverse:["boolean",sizeInt],reversalSpeed:sizeInt,onBeatZoom:sizeInt,onBeat:["boolean",sizeInt],bilinear:["boolean",sizeInt]}},{name:"SVP",code:10,group:"Render",func:"generic",fields:{library:["SizeString",260]}},{name:"Colorfade",code:11,group:"Trans",func:"generic",fields:{enabled:["Bit",0,"Boolified"],onBeat:["Bit",2,"Boolified"],onBeatRandom:["Bit",1,"Boolified"],null0:sizeInt-1,fader1:"Int32",fader2:"Int32",fader3:"Int32",beatFader1:"Int32",beatFader2:"Int32",beatFader3:"Int32"}},{name:"Color Clip",code:12,group:"Trans",func:"generic",fields:{mode:["Map4",{0:"Off",1:"Below",2:"Above",3:"Near"}],colorFrom:"Color",colorTo:"Color",colorDistance:sizeInt}},{name:"Rotating Stars",code:13,group:"Render",func:"generic",fields:{colors:"ColorList"}},{name:"Ring",code:14,group:"Render",func:"generic",fields:{audioChannel:["Bit",[2,3],"AudioChannel"],positionX:["Bit",[4,5],"PositionX"],null0:sizeInt-1,colors:"ColorList",size:sizeInt,audioSource:["UInt32",sizeInt,"AudioSource"]}},{name:"Movement",code:15,group:"Trans",func:"movement"},{name:"Scatter",code:16,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt]}},{name:"Dot Grid",code:17,group:"Render",func:"generic",fields:{colors:"ColorList",spacing:sizeInt,speedX:"Int32",speedY:"Int32",output:["Map4",{0:"Replace",1:"Additive",2:"50/50",3:"Default"}]}},{name:"Buffer Save",code:18,group:"Misc",func:"generic",fields:{mode:["BufferMode",sizeInt],buffer:["BufferNum",sizeInt],blend:["BlendmodeBuffer",sizeInt],adjustBlend:sizeInt}},{name:"Dot Fountain",code:19,group:"Render",func:"generic",fields:{rotationSpeed:"Int32",colorTop:"Color",colorHigh:"Color",colorMid:"Color",colorLow:"Color",colorBottom:"Color",angle:"Int32",null0:sizeInt}},{name:"Water",code:20,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt]}},{name:"Comment",code:21,group:"Misc",func:"generic",fields:{text:"SizeString"}},{name:"Brightness",code:22,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],red:"Int32",green:"Int32",blue:"Int32",separate:["Bool",sizeInt],excludeColor:"Color",exclude:["Bool",sizeInt],distance:sizeInt}},{name:"Interleave",code:23,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],x:sizeInt,y:sizeInt,color:"Color",output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],onbeat:["Bool",sizeInt],x2:sizeInt,y2:sizeInt,beatDuration:sizeInt}},{name:"Grain",code:24,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],amount:sizeInt,"static":["Bool",sizeInt]}},{name:"Clear Screen",code:25,group:"Render",func:"generic",fields:{enabled:["Bool",sizeInt],color:["Color",sizeInt],output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50",2:"Default"}],onlyFirst:["Bool",sizeInt]}},{name:"Mirror",code:26,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],topToBottom:["Bit",0,"Boolified"],bottomToTop:["Bit",1,"Boolified"],leftToRight:["Bit",2,"Boolified"],rightToLeft:["Bit",3,"Boolified"],null0:sizeInt-1,onBeat:["Bool",sizeInt],smooth:["Bool",sizeInt],speed:sizeInt}},{name:"Starfield",code:27,group:"Render",func:"generic",fields:{enabled:sizeInt,color:"Color",output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],WarpSpeed:["Float32",sizeInt],MaxStars_set:sizeInt,onbeat:sizeInt,spdBeat:["Float32",sizeInt],durFrames:sizeInt}},{name:"Text",code:28,group:"Render",func:"generic",fields:{enabled:["Bool",sizeInt],color:["Color",sizeInt],output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],onBeat:["Bool",sizeInt],insertBlanks:["Bool",sizeInt],randomPosition:["Bool",sizeInt],verticalAlign:["Map4",{0:"Top",4:"Center",8:"Bottom"}],horizontalAlign:["Map4",{0:"Left",1:"Center",2:"Right"}],onBeatSpeed:sizeInt,normSpeed:sizeInt,null0:60,null1:4*sizeInt,weight:["Map4",{0:"Dontcare",100:"Thin",200:"Extralight",200:"Ultralight",300:"Light",400:"Normal",400:"Regular",500:"Medium",600:"Semibold",600:"Demibold",700:"Bold",800:"Extrabold",800:"Ultrabold",900:"Heavy",900:"Black"}],italic:["Bool",1],underline:["Bool",1],strikeOut:["Bool",1],charSet:1,null2:4,fontName:["SizeString",32],text:["SizeString",0,"SemiColSplit"],outline:["Bool",sizeInt],outlineColor:"Color",shiftX:sizeInt,shiftY:sizeInt,outlineShadowSize:sizeInt,randomWord:["Bool",sizeInt],shadow:["Bool",sizeInt]}},{name:"Bump",code:29,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],onBeat:["Bool",sizeInt],duration:sizeInt,depth:sizeInt,onBeatDepth:sizeInt,output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],code:"CodeFBI",showDot:["Bool",sizeInt],invertDepth:["Bool",sizeInt],null0:sizeInt,depthBuffer:["BufferNum",sizeInt]}},{name:"Mosaic",code:30,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],size:sizeInt,onBeatSize:sizeInt,output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],onbeat:["Bool",sizeInt],durFrames:sizeInt}},{name:"Water Bump",code:31,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],density:sizeInt,depth:sizeInt,random:["Bool",sizeInt],dropPositionX:sizeInt,dropPositionY:sizeInt,dropRadius:sizeInt,method:sizeInt}},{name:"AVI",code:32,group:"Trans",func:"avi"},{name:"Custom BPM",code:33,group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],mode:["RadioButton",{0:"Arbitrary",1:"Skip",2:"Reverse"}],arbitraryValue:sizeInt,skipValue:sizeInt,skipFirstBeats:sizeInt}},{name:"Picture",code:34,group:"Render",func:"generic",fields:{enabled:["Bool",sizeInt],output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],adapt:sizeInt,onBeatPersist:sizeInt,file:"NtString",ratio:sizeInt,aspectRatioAxis:["Map4",{0:"X",1:"Y"}]}},{name:"Dynamic Distance Modifier",code:35,group:"Trans",func:"generic",fields:{null0:1,code:"CodePFBI",output:["Map4",{0:"Replace",1:"50/50"}],bilinear:["Bool",sizeInt]}},{name:"Super Scope",code:36,group:"Render",func:"generic",fields:{version:["Bool",1],code:"CodePFBI",audioChannel:["Bit",[0,1],"AudioChannel"],audioSource:["Bit",2,"AudioSource"],null0:3,colors:"ColorList",lineType:["DrawMode",sizeInt]}},{name:"Invert",code:37,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt]}},{name:"Unique Tone",code:38,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],color:"Color",output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],invert:["Bool",sizeInt]}},{name:"Timescope",code:39,group:"Render",func:"generic",fields:{enabled:["Bool",sizeInt],color:"Color",output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50",2:"Default"}],audioChannel:["UInt32",sizeInt,"AudioChannel"],bands:sizeInt}},{name:"Set Render Mode",code:40,group:"Misc",func:"generic",fields:{blend:["BlendmodeRender",1],adjustBlend:1,lineSize:1,enabled:["Bit",7,"Boolified"]}},{name:"Interference",code:41,group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],numberOfLayers:sizeInt,null0:sizeInt,distance:sizeInt,alpha:sizeInt,rotation:"Int32",output:["Map8",{0:"Replace",1:"Additive",4294967296:"50/50"}],onBeatDistance:sizeInt,onBeatAlpha:sizeInt,onBeatRotation:sizeInt,separateRGB:["Bool",sizeInt],onBeat:["Bool",sizeInt],speed:"Float32"}},{name:"Dynamic Shift",code:42,group:"Trans",func:"generic",fields:{version:["Bool",1],code:"CodeIFB",output:["Map4",{0:"Replace",1:"50/50"}],bilinear:["Bool",sizeInt]}},{name:"Dynamic Movement",code:43,group:"Trans",func:"generic",fields:{version:["Bool",1],code:"CodePFBI",bilinear:["Bool",sizeInt],coordinates:["Coordinates",sizeInt],gridW:sizeInt,gridH:sizeInt,alpha:["Bool",sizeInt],wrap:["Bool",sizeInt],buffer:["BufferNum",sizeInt],alphaOnly:["Bool",sizeInt]}},{name:"Fast Brightness",code:44,group:"Trans",func:"generic",fields:{factor:["Map4",{0:2,1:.5,2:1}]}},{name:"Color Modifier",code:45,group:"Trans",func:"generic",fields:{recomputeEveryFrame:["Bool",1],code:"CodePFBI"}}],dllComponents=[{name:"AVS Trans Automation",code:[77,105,115,99,58,32,65,86,83,84,114,97,110,115,32,65,117,116,111,109,97,116,105,111,110,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],logging:["Bool",sizeInt],translateFirstLevel:["Bool",sizeInt],readCommentCodes:["Bool",sizeInt],code:"NtString"}},{name:"Texer II",code:[65,99,107,111,46,110,101,116,58,32,84,101,120,101,114,32,73,73,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Render",func:"generic",fields:{null0:sizeInt,image:["SizeString",260],resizing:["Bool",sizeInt],wrap:["Bool",sizeInt],coloring:["Bool",sizeInt],null1:sizeInt,code:"CodeIFBP"}},{name:"Color Map",code:[67,111,108,111,114,32,77,97,112,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{key:["KeyColorMap",sizeInt],output:["BlendmodeColorMap",sizeInt],mapCycling:["CycleModeColorMap",sizeInt],null0:2,dontSkipFastBeats:["Bool",1],cycleSpeed:1,maps:"ColorMaps"}},{name:"Framerate Limiter",code:[86,70,88,32,70,82,65,77,69,82,65,84,69,32,76,73,77,73,84,69,82,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],limit:sizeInt}},{name:"Convolution Filter",code:[72,111,108,100,101,110,48,51,58,32,67,111,110,118,111,108,117,116,105,111,110,32,70,105,108,116,101,114,0,0,0,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],wrap:["Bool",sizeInt],absolute:["Bool",sizeInt],"2-pass":["Bool",sizeInt],kernel:["ConvoFilter",[7,7]],bias:"Int32",scaling:"Int32"}},{name:"Triangle",code:[82,101,110,100,101,114,58,32,84,114,105,97,110,103,108,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{code:"NtCodeIFBP"}},{name:"Channel Shift",code:[67,104,97,110,110,101,108,32,83,104,105,102,116,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{mode:["Map4",{1144:"RGB",1020:"RBG",1019:"BRG",1021:"BGR",1018:"GBR",1022:"GRB"}],onBeatRandom:["Bool",sizeInt]}},{name:"Normalize",code:[84,114,97,110,115,58,32,78,111,114,109,97,108,105,115,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt]}},{name:"Video Delay",code:[72,111,108,100,101,110,48,52,58,32,86,105,100,101,111,32,68,101,108,97,121,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{enabled:["Bool",sizeInt],useBeats:["Bool",sizeInt],delay:sizeInt}},{name:"Multiplier",code:[77,117,108,116,105,112,108,105,101,114,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{multiply:["Map4",{0:"Infinite Root",1:8,2:4,3:2,4:.5,5:.25,6:.125,7:"Infinite Square"}]}},{name:"Color Reduction",code:[67,111,108,111,114,32,82,101,100,117,99,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{null0:260,colors:["Map4",{1:2,2:4,3:8,4:16,5:32,6:64,7:128,8:256}]}},{name:"Multi Delay",code:[72,111,108,100,101,110,48,53,58,32,77,117,108,116,105,32,68,101,108,97,121,0,0,0,0,0,0,0,0,0,0,0],group:"Trans",func:"generic",fields:{mode:["Map4",{0:"Disabled",1:"Input",2:"Output"}],activeBuffer:sizeInt,useBeats0:["Bool",sizeInt],delay0:sizeInt,useBeats1:["Bool",sizeInt],delay1:sizeInt,useBeats2:["Bool",sizeInt],delay2:sizeInt,useBeats3:["Bool",sizeInt],delay3:sizeInt,useBeats4:["Bool",sizeInt],delay4:sizeInt,useBeats5:["Bool",sizeInt],delay5:sizeInt}},{name:"MIDI Trace",code:[78,117,108,108,115,111,102,116,32,80,105,120,101,108,99,111,114,112,115,58,32,77,73,68,73,116,114,97,99,101,32,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],channel:sizeInt,mode:["Map4",{1:"Current",2:"Trigger"}],allChannels:["Bool",sizeInt],printEvents:["Bool",sizeInt]}},{name:"Add Borders",code:[86,105,114,116,117,97,108,32,69,102,102,101,99,116,58,32,65,100,100,98,111,114,100,101,114,115,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt],color:"Color",size:sizeInt}},{name:"AVI Player",code:[86,70,88,32,65,86,73,32,80,76,65,89,69,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{filePath:["SizeString",256],enabled:["Bool",sizeInt]}},{name:"FyrewurX",code:[70,117,110,107,121,70,88,32,70,121,114,101,119,117,114,88,32,118,49,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{enabled:["Bool",sizeInt]}},{name:"Global Variables",code:[74,104,101,114,105,107,111,58,32,71,108,111,98,97,108,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{load:["Map4",{0:"None",1:"Once",2:"CodeControl",3:"EveryFrame"}],null0:6*sizeInt,code:"NtCodeIFB",file:"NtString",saveRegRange:"NtString",saveBufRange:"NtString"}},{name:"Fluid",code:[71,101,105,115,115,70,108,117,105,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{null0:sizeInt}},{name:"Picture II",code:[80,105,99,116,117,114,101,32,73,73,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],group:"Misc",func:"generic",fields:{image:["NtString",260],output:["BlendmodePicture2",sizeInt],onBeatOutput:["BlendmodePicture2",sizeInt],bilinear:["Bool",sizeInt],onBeatBilinear:["Bool",sizeInt],adjustBlend:sizeInt,onBeatAdjustBlend:sizeInt}}],componentTable=builtinComponents.concat(dllComponents),compat=!1,outputDir="",pedanticMode=!1,verbose=!0,allFields=!0,prettyPrint=!0;$(document).ready(function(){checkCompat(),log("File API check: "+(compat?"success":"fail")+".");var a=[];$("#preset").change(function(){a=loadDir(this,/\.avs$/),log("Found "+a.length+" files in directory.");for(var b=0;b<a.length;b++)loadFile(a[b],saveAvsAsJson)})});var blendmodesIn={0:"Ignore",1:"Replace",2:"50/50",3:"Maximum",4:"Additive",5:"Dest-Src",6:"Src-Dest",7:"EveryOtherLine",8:"EveryOtherPixel",9:"XOR",10:"Adjustable",11:"Multiply",12:"Buffer"},blendmodesOut={0:"Replace",1:"Ignore",2:"Maximum",3:"50/50",4:"Dest-Src",5:"Additive",6:"EveryOtherLine",7:"Src-Dest",8:"XOR",9:"EveryOtherPixel",10:"Multiply",11:"Adjustable",13:"Buffer"},blendmodesBuffer={0:"Replace",1:"50/50",2:"Additive",5:"EveryOtherPixel",4:"Dest-Src",5:"EveryOtherLine",6:"XOR",7:"Maximum",8:"Minimum",9:"Src-Dest",10:"Multiply",11:"Adjustable"},blendmodesRender={0:"Replace",1:"Additive",2:"Maximum",3:"50/50",4:"Dest-Src",5:"Src-Dest",6:"Multiply",7:"Adjustable",8:"XOR"},blendmodesPicture2={0:"Replace",1:"Additive",2:"Maximum",3:"Minimum",4:"50/50",5:"Dest-Src",6:"Src-Dest",7:"Multiply",8:"XOR",9:"Adjustable",10:"Ignore"},blendmodesColorMap={0:"Replace",1:"Additive",2:"Maximum",3:"50/50",4:"Dest-Src",5:"Src-Dest",6:"Multiply",7:"Adjustable",8:"XOR"},keysColorMap={0:"Red",1:"Green",2:"Blue",3:"(R+G+B)/2",4:"MaxChannel",5:"(R+G+B)/3"},cycleModesColorMap={0:"None (Map 1)",1:"OnBeat Random",2:"OnBeat Sequential"},buffermodes={0:"Save",1:"Restore",2:"AlternateSaveRestore",3:"AlternateRestoreSave"},coordinates={0:"Polar",1:"Cartesian"},drawModes={0:"Dots",1:"Lines"},audioChannels={0:"Left",1:"Right",2:"Center"},audioSources={0:"Waveform",1:"Spectrum"},positionsX={0:"Left",1:"Right",2:"Center"},positionsY={0:"Top",1:"Bottom",2:"Center"},movementEffects={0:["None","",0],1:["Slight Fuzzify","",0],2:["Shift Rotate Left","x=x+1/32; // use wrap for this one",1],3:["Big Swirl Out","r = r + (0.1 - (0.2 * d));\r\nd = d * 0.96;",0],4:["Medium Swirl","d = d * (0.99 * (1.0 - sin(r-$PI*0.5) / 32.0));\r\nr = r + (0.03 * sin(d * $PI * 4));",0],5:["Sunburster","d = d * (0.94 + (cos((r-$PI*0.5) * 32.0) * 0.06));",0],6:["Swirl To Center","d = d * (1.01 + (cos((r-$PI*0.5) * 4) * 0.04));\r\nr = r + (0.03 * sin(d * $PI * 4));",0],7:["Blocky Partial Out","",0],8:["Swirling Around Both Ways At Once","r = r + (0.1 * sin(d * $PI * 5));",0],9:["Bubbling Outward","t = sin(d * $PI);\r\nd = d - (8*t*t*t*t*t)/sqrt((sw*sw+sh*sh)/4);",0],10:["Bubbling Outward With Swirl","t = sin(d * $PI);\r\nd = d - (8*t*t*t*t*t)/sqrt((sw*sw+sh*sh)/4);\r\nt=cos(d*$PI/2.0);\r\nr= r + 0.1*t*t*t;",0],11:["5 Pointed Distro","d = d * (0.95 + (cos(((r-$PI*0.5) * 5.0) - ($PI / 2.50)) * 0.03));",0],12:["Tunneling","r = r + 0.04;\r\nd = d * (0.96 + cos(d * $PI) * 0.05);",0],13:["Bleedin'","t = cos(d * $PI);\r\nr = r + (0.07 * t);\r\nd = d * (0.98 + t * 0.10);",0],14:["Shifted Big Swirl Out","d=sqrt(x*x+y*y); r=atan2(y,x);\r\nr=r+0.1-0.2*d; d=d*0.96;\r\nx=cos(r)*d + 8/128; y=sin(r)*d;",0,1],15:["Psychotic Beaming Outward","d = 0.15",0],16:["Cosine Radial 3-way","r = cos(r * 3)",0],17:["Spinny Tube","d = d * (1 - ((d - .35) * .5));\r\nr = r + .1;",0],18:["Radial Swirlies","d = d * (1 - (sin((r-$PI*0.5) * 7) * .03));\r\nr = r + (cos(d * 12) * .03);",0],19:["Swill","d = d * (1 - (sin((r - $PI*0.5) * 12) * .05));\r\nr = r + (cos(d * 18) * .05);\r\nd = d * (1-((d - .4) * .03));\r\nr = r + ((d - .4) * .13)",0],20:["Gridley","x = x + (cos(y * 18) * .02);\r\ny = y + (sin(x * 14) * .03);",1],21:["Grapevine","x = x + (cos(abs(y-.5) * 8) * .02);\r\ny = y + (sin(abs(x-.5) * 8) * .05);\r\nx = x * .95;\r\ny = y * .95;",1],22:["Quadrant","y = y * ( 1 + (sin(r + $PI/2) * .3) );\r\nx = x * ( 1 + (cos(r + $PI/2) * .3) );\r\nx = x * .995;\r\ny = y * .995;",1],23:["6-way Kaleida (use Wrap!)","y = (r*6)/($PI); x = d;",1]};hljs.initHighlightingOnLoad(),$(function(){$("#output").click(function(){SelectText("output")})});var sizeInt=4,presetHeaderLength=25,builtinMax=16384;